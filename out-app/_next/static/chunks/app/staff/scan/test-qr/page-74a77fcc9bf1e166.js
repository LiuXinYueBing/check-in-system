(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[788],{4765:function(e,t,n){Promise.resolve().then(n.bind(n,5164))},5164:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(7437),s=n(2265),o=n(1377),l=n(8473),c=n(6763);function u(){let{addToast:e}=(0,c.p)(),t=(0,s.useRef)(null),n="qr-test-container",u=(0,s.useRef)(null),[i,a]=(0,s.useState)(!1);(0,s.useEffect)(()=>{l.k.log("\uD83D\uDD0D 测试页面加载，初始化扫描器...");let e=setTimeout(()=>{h()},100);return()=>{clearTimeout(e),g(),D()}},[]);let d=()=>{l.k.log("\uD83D\uDD27 简化样式修复 (测试页面)...");let e=document.getElementById(n);e&&(["button","select","label"].forEach(t=>{e.querySelectorAll(t).forEach(e=>{e.style.display="none"})}),e.querySelectorAll("span, div, a").forEach(e=>{var t;let n=(null===(t=e.textContent)||void 0===t?void 0:t.trim())||"";(n.includes("Select Camera")||n.includes("Stop Scanning"))&&(l.k.log("✅ 修复文字旋转 (测试): ".concat(n)),e.style.transform="none",e.style.animation="none",e.style.transition="none")}),l.k.log("✅ 测试页面样式修复完成"))},m=()=>{l.k.log("⏰ 启动简化样式修复定时器 (测试页面)..."),d(),u.current=setInterval(()=>{d()},1e3)},D=()=>{u.current&&(clearInterval(u.current),u.current=null)},h=()=>{l.k.log("\uD83D\uDE80 开始启动扫描器...");try{if(!document.getElementById(n)){l.k.error("❌ 容器不存在:",n);return}l.k.log("✅ 容器存在，创建扫描器...");let r=new o.w(n,{fps:10,qrbox:{width:250,height:250},supportedScanTypes:[0]},!1);r.render(t=>{l.k.log("✅ 扫描成功:",t),e({type:"success",title:"扫描成功",message:"扫描内容: ".concat(t)})},e=>{e&&!e.includes("No QR code found")&&l.k.warn("⚠️ 扫描错误:",e)}),t.current=r,l.k.log("✅ 扫描器创建成功"),setTimeout(()=>{m()},1e3)}catch(e){l.k.error("❌ 扫描器启动失败:",e)}},g=()=>{if(D(),t.current){try{t.current.clear(),l.k.log("\uD83D\uDED1 扫描器已停止")}catch(e){l.k.warn("⚠️ 停止扫描器时出错:",e)}t.current=null}};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-center mb-4",children:"\uD83D\uDCF1 摄像头扫码测试"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,r.jsx)("div",{className:"text-center mb-4",children:(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"这是一个最简单的扫码测试页面，用于验证摄像头功能是否正常"})}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("div",{id:n,className:"w-full border-2 border-dashed border-gray-300 rounded-lg",style:{minHeight:"300px"}})}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{l.k.log("\uD83D\uDD04 重启扫描器"),g(),setTimeout(()=>{h()},500)},className:"flex-1 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"\uD83D\uDD04 重启扫描器"}),(0,r.jsx)("button",{onClick:g,className:"flex-1 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors",children:"\uD83D\uDED1 停止扫描"})]}),(0,r.jsxs)("div",{className:"mt-4 p-3 bg-gray-100 rounded text-xs",children:[(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:"调试信息:"})}),(0,r.jsxs)("p",{children:["• 容器ID: ",n]}),(0,r.jsx)("p",{children:"• 请打开浏览器控制台查看详细日志"}),(0,r.jsx)("p",{children:"• 如果看不到扫描界面，点击重启按钮"}),(0,r.jsx)("p",{children:"• 确保已授权摄像头权限"})]})]}),(0,r.jsx)("div",{className:"mt-4 text-center",children:(0,r.jsx)("a",{href:"/staff/scan",className:"text-blue-500 underline text-sm",children:"← 返回原扫码页面"})})]})})}},6763:function(e,t,n){"use strict";n.d(t,{p:function(){return o},u:function(){return s}});var r=n(2265);let s=(0,r.createContext)(void 0),o=()=>{let e=(0,r.useContext)(s);if(!e)throw Error("useToast must be used within a ToastProvider");return e}},8473:function(e,t,n){"use strict";n.d(t,{k:function(){return s}});class r{formatMessage(e,t,n){let r=new Date().toISOString(),s=this.getEmoji(e);return"".concat(s," [").concat(r,"] ").concat(t)}getEmoji(e){switch(e){case"log":return"\uD83D\uDD0D";case"error":return"❌";case"warn":return"⚠️";case"debug":return"\uD83D\uDC1B";default:return"\uD83D\uDCDD"}}log(e,t){this.isDevelopment&&console.log(this.formatMessage("log",e,t),t||"")}error(e,t){console.error(this.formatMessage("error",e,t),t||"")}warn(e,t){this.isDevelopment&&console.warn(this.formatMessage("warn",e,t),t||"")}debug(e,t){this.isDevelopment&&console.debug(this.formatMessage("debug",e,t),t||"")}group(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isDevelopment&&(t?console.groupCollapsed("\uD83D\uDCC1 ".concat(e)):console.group("\uD83D\uDCC1 ".concat(e)))}groupEnd(){this.isDevelopment&&console.groupEnd()}time(e){this.isDevelopment&&console.time("⏱️ ".concat(e))}timeEnd(e){this.isDevelopment&&console.timeEnd("⏱️ ".concat(e))}table(e,t){this.isDevelopment&&console.table(e,t)}constructor(){this.isDevelopment=!1}}let s=new r}},function(e){e.O(0,[52,377,971,23,744],function(){return e(e.s=4765)}),_N_E=e.O()}]);