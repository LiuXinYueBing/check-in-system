(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[719],{9054:function(e,t,s){Promise.resolve().then(s.bind(s,1668))},1668:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var r=s(7437),a=s(2265),n=s(4316),i=s(8473),l=s(9733),c=s(8185),o=s(9055),d=s(933),u=s(5862),m=s(9738),x=s(2810),h=s(9321),g=s(2421),f=s(4258),b=s(2022),N=s(6997),p=s(7818),j=s(4109);let v=(0,p.default)(()=>s.e(516).then(s.bind(s,5516)),{loadableGenerated:{webpack:()=>[5516]},ssr:!1,loading:()=>(0,r.jsx)("div",{className:"flex items-center justify-center min-h-64",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(j.Z,{className:"animate-spin h-8 w-8 text-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"正在加载扫码功能..."})]})})});function y(e){let{onScanSuccess:t,isActive:s}=e;return(0,r.jsx)(v,{onScanSuccess:t,isActive:s})}class E extends a.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){i.k.error("\uD83D\uDEA8 ScannerErrorBoundary 捕获到错误:",{error:e,errorInfo:t}),(e.message.includes("window is not defined")||e.message.includes("navigator is not defined")||e.message.includes("document is not defined")||e.message.includes("localStorage is not defined"))&&i.k.warn("⚠️ 检测到SSR相关错误，这通常是正常的，因为扫码组件仅在客户端运行"),this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-64",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-lg mx-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl mb-4",children:"\uD83D\uDEA8"}),(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"扫码组件发生错误"}),this.state.error&&(0,r.jsx)("div",{className:"mb-4 text-left",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-red-800 mb-2",children:"错误信息:"}),(0,r.jsx)("p",{className:"font-mono text-sm text-red-700 break-all",children:this.state.error.toString()}),(0,r.jsxs)("div",{className:"mt-2 pt-2 border-t border-red-200",children:[(0,r.jsxs)("p",{className:"text-xs text-red-600",children:["错误类型: ",this.state.error.name||"Unknown"]}),this.state.error.message&&(0,r.jsxs)("p",{className:"text-xs text-red-600 mt-1",children:["详细信息: ",this.state.error.message]})]})]})}),this.state.errorInfo&&(0,r.jsxs)("details",{className:"mb-4 text-left",children:[(0,r.jsx)("summary",{className:"text-sm text-blue-600 cursor-pointer mb-2",children:"\uD83D\uDCCB 查看组件堆栈"}),(0,r.jsx)("div",{className:"bg-gray-100 p-3 rounded text-xs overflow-auto max-h-48",children:(0,r.jsx)("pre",{className:"whitespace-pre-wrap text-gray-700",children:this.state.errorInfo.componentStack})})]}),this.state.error&&(0,r.jsxs)("div",{className:"mb-4 text-left bg-blue-50 border border-blue-200 rounded p-3",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-blue-800 mb-1",children:"\uD83D\uDCA1 可能的原因:"}),(0,r.jsxs)("ul",{className:"text-xs text-blue-700 space-y-1",children:[this.state.error.toString().includes("window is not defined")&&(0,r.jsx)("li",{children:"• SSR环境冲突 - 正常情况，扫码组件仅在客户端运行"}),this.state.error.toString().includes("navigator")&&(0,r.jsx)("li",{children:"• 浏览器API访问问题 - 请使用现代浏览器"}),this.state.error.toString().includes("Camera")&&(0,r.jsx)("li",{children:"• 摄像头权限或设备问题 - 请检查摄像头设置"}),this.state.error.toString().includes("html5-qrcode")&&(0,r.jsx)("li",{children:"• 扫码库加载问题 - 可能是网络或兼容性问题"}),!this.state.error.toString().includes("window")&&!this.state.error.toString().includes("navigator")&&!this.state.error.toString().includes("Camera")&&!this.state.error.toString().includes("html5-qrcode")&&(0,r.jsx)("li",{children:"• 组件渲染或逻辑错误 - 需要进一步调试"})]})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"请尝试以下解决方案:"}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsx)(l.z,{onClick:this.handleReset,className:"w-full",children:"\uD83D\uDD04 重试组件"}),(0,r.jsx)(l.z,{onClick:this.handleReload,variant:"outline",className:"w-full",children:"\uD83D\uDD04 刷新页面"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"如果问题持续存在，请截图此错误页面联系技术支持"})]})})}):this.props.children}constructor(e){super(e),this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.handleReload=()=>{window.location.reload()},this.state={hasError:!1,error:null,errorInfo:null}}}let w=()=>{try{let e="__test__";return localStorage.setItem(e,"test"),localStorage.removeItem(e),!0}catch(e){return!1}},D=(e,t)=>{if(!w())return t;try{let s=localStorage.getItem(e);if(null===s)return t;try{return JSON.parse(s)}catch(e){return s}}catch(s){return console.warn('Failed to get localStorage item "'.concat(e,'":'),s),t}},S=(e,t)=>{if(!w())return!1;try{let s="string"==typeof t?t:JSON.stringify(t);return localStorage.setItem(e,s),!0}catch(t){return console.warn('Failed to set localStorage item "'.concat(e,'":'),t),!1}};var _=s(2686);function C(){let[e,t]=(0,a.useState)(null),[p,j]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!1),[C,T]=(0,a.useState)([]),[I,A]=(0,a.useState)(""),[k,R]=(0,a.useState)(""),[O,F]=(0,a.useState)(!0),[M,L]=(0,a.useState)(!1),[U,Y]=(0,a.useState)({total:0,registered:0,checkedIn:0,redeemed:0,loading:!0}),[Z,z]=(0,a.useState)({show:!1,type:"error",message:""}),[P,B]=(0,a.useState)(!0),[W,J]=(0,a.useState)(_.dn.DEFAULT_WAIT_TIME),[V,q]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=D(_.Pd.STAFF_AUTO_CONTINUE_SCAN,!0),t=D(_.Pd.STAFF_WAIT_TIME,_.dn.DEFAULT_WAIT_TIME);B(e),J(t)},[]),(0,a.useEffect)(()=>{S(_.Pd.STAFF_AUTO_CONTINUE_SCAN,P)},[P]),(0,a.useEffect)(()=>{S(_.Pd.STAFF_WAIT_TIME,W)},[W]),(0,a.useEffect)(()=>{H()},[]),(0,a.useEffect)(()=>{s.e(104).then(s.t.bind(s,381,23)).then(e=>{let{default:t}=e;new t}).catch(e=>{console.warn("Failed to load vConsole:",e)})},[]);let H=async()=>{try{i.k.log("\uD83D\uDD04 开始获取活动列表..."),F(!0);let{data:e,error:t}=await n.O.from("events").select("*").order("created_at",{ascending:!1});if(t){i.k.error("❌ Fetch events error:",t),Q("error","无法获取活动列表: ".concat(t.message));return}i.k.log("✅ 成功获取活动列表，数量:",(null==e?void 0:e.length)||0),T(e||[]);let s=D(_.Pd.STAFF_SELECTED_EVENT_ID,""),r=D(_.Pd.STAFF_SELECTED_EVENT_NAME,"");s&&r?(i.k.log("\uD83D\uDCCB 找到缓存活动:",r),A(s),R(r),L(!1),w(!0),G(s)):(i.k.log("\uD83D\uDCCB 未找到缓存活动，显示选择器"),L(!0),w(!1))}catch(e){i.k.error("Fetch events error:",e),Q("error","无法获取活动列表")}finally{F(!1)}},X=(e,t,s)=>{i.k.log("\uD83C\uDFAF 选择活动:",t),A(e),R(t),L(!1),S(_.Pd.STAFF_SELECTED_EVENT_ID,e),S(_.Pd.STAFF_SELECTED_EVENT_NAME,"".concat(t," - ").concat(s)),w(!0),G(e)},G=async e=>{Y(e=>({...e,loading:!0}));try{let{data:t,error:s}=await n.O.from("attendees").select("*").eq("event_id",e);if(s)throw s;let r=(t||[]).reduce((e,t)=>{switch(e.total++,t.status){case _.o3.REGISTERED:e.registered++;break;case _.o3.CHECKED_IN:e.checkedIn++;break;case _.o3.REDEEMED:e.redeemed++}return e},{total:0,registered:0,checkedIn:0,redeemed:0});Y({...r,loading:!1})}catch(e){i.k.error("Fetch event stats error:",e),Y({total:0,registered:0,checkedIn:0,redeemed:0,loading:!1})}},K=()=>{i.k.log("\uD83D\uDD04 切换活动，停止扫描"),w(!1),L(!0),Y({total:0,registered:0,checkedIn:0,redeemed:0,loading:!0})},Q=(e,t)=>{z({show:!0,type:e,message:t}),setTimeout(()=>{z({show:!1,type:"error",message:""})},_.MO.NOTIFICATION_DURATION)},$=async e=>{w(!1);try{let{data:s,error:r}=await n.O.from("attendees").select("\n          *,\n          events (*)\n        ").eq("id",e).single();if(r){i.k.error("Fetch attendee error:",r),Q("error","查询失败，无法查询用户信息"),setTimeout(()=>{w(!0)},_.MO.SCAN_RESULT_DELAY);return}if(s.event_id!==I){Q("warning","⚠️ 场次错误！该用户属于其他活动，请核实！"),setTimeout(()=>{w(!0)},_.MO.SCAN_RESULT_DELAY);return}t(s),G(I)}catch(e){i.k.error("Scan fetch error:",e),Q("error","查询失败，无法查询用户信息"),setTimeout(()=>{w(!0)},_.MO.SCAN_RESULT_DELAY)}},ee=()=>{i.k.log("\uD83D\uDD04 恢复扫描状态"),i.k.log("\uD83D\uDCCA 当前状态:",{attendee:e?e.name:null,scanning:v,autoContinueScan:P,waitTime:W}),t(null),w(!0)},et=async()=>{if(e){j(!0);try{let{error:s}=await n.O.from("attendees").update({status:"checked_in",check_in_time:new Date().toISOString()}).eq("id",e.id);if(s)throw s;Q("success","".concat(e.name," 已成功入场"));let{data:r}=await n.O.from("attendees").select("*").eq("id",e.id).single();r&&t(r),G(I),P?setTimeout(()=>{i.k.log("⏱️ ".concat(W,"秒后自动继续扫描...")),ee(),j(!1)},1e3*W):j(!1)}catch(e){i.k.error("Check-in error:",e),Q("error","操作失败，请稍后重试"),setTimeout(()=>{ee(),j(!1)},_.MO.ERROR_RETRY_DELAY)}}},es=async()=>{if(e){j(!0);try{let{error:s}=await n.O.from("attendees").update({status:"redeemed",redeem_time:new Date().toISOString()}).eq("id",e.id);if(s)throw s;Q("success","".concat(e.name," 已完成核销"));let{data:r}=await n.O.from("attendees").select("*").eq("id",e.id).single();r&&t(r),G(I),P?setTimeout(()=>{i.k.log("⏱️ ".concat(W,"秒后自动继续扫描...")),ee(),j(!1)},1e3*W):j(!1)}catch(e){i.k.error("Redeem error:",e),Q("error","操作失败，请稍后重试"),setTimeout(()=>{ee(),j(!1)},_.MO.ERROR_RETRY_DELAY)}}},er=e=>{switch(e){case _.o3.REGISTERED:return{text:"待入场",color:"registered",icon:d.Z,description:"请确认用户入场",action:"confirmCheckIn",actionText:"确认入场",actionColor:"bg-green-600 hover:bg-green-700"};case _.o3.CHECKED_IN:return{text:"已入场",color:"checkedIn",icon:u.Z,description:"可以核销抵用券",action:"redeem",actionText:"核销抵用券",actionColor:"bg-orange-600 hover:bg-orange-700"};case _.o3.REDEEMED:return{text:"已核销",color:"redeemed",icon:m.Z,description:"该用户已完成核销",action:null,actionText:"",actionColor:""};default:return{text:"未知状态",color:"default",icon:d.Z,description:"请联系工作人员",action:null,actionText:"",actionColor:""}}};return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 px-4 py-8",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-primary-500 to-primary-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:(0,r.jsx)(x.Z,{className:"w-10 h-10 text-white"})}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"员工工作台"}),(0,r.jsx)("p",{className:"text-gray-600",children:"选择当前活动场次，扫码核验用户凭证"})]}),M&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-auto p-6 space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"选择活动场次"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"请选择您要执行签到/核销的活动"}),O?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"正在加载活动列表..."})]}):(0,r.jsx)("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:0===C.length?(0,r.jsx)("p",{className:"text-center text-gray-500 py-8",children:"暂无活动"}):C.map(e=>(0,r.jsxs)("div",{onClick:()=>X(e.id,e.name,e.location||"未指定地点"),className:"p-4 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[(0,r.jsx)(h.Z,{className:"w-4 h-4 mr-1"}),e.location]})]},e.id))}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(l.z,{onClick:K,variant:"outline",className:"mt-4",children:"取消"})})]})}),I&&!M&&(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-blue-900",children:["当前活动：",k]}),(0,r.jsxs)(l.z,{onClick:K,variant:"outline",size:"sm",children:[(0,r.jsx)(g.Z,{className:"w-4 h-4 mr-1"}),"切换活动"]})]})}),I&&!M&&(0,r.jsxs)("div",{className:"bg-gray-50 border rounded-xl shadow-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f.Z,{className:"w-4 h-4 text-gray-600"}),(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"自动继续扫描设置"})]}),(0,r.jsx)(l.z,{onClick:()=>q(!V),variant:"ghost",size:"sm",className:"text-gray-600 hover:text-gray-900",children:V?"收起":"展开"})]}),(0,r.jsxs)("div",{className:"space-y-3 ".concat(V?"block":"hidden"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("label",{className:"text-sm text-gray-700",children:"扫码后自动继续"}),(0,r.jsx)("button",{onClick:()=>B(!P),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors ".concat(P?"bg-blue-600":"bg-gray-200"),children:(0,r.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(P?"translate-x-6":"translate-x-1")})})]}),P&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("label",{className:"text-sm text-gray-700",children:"等待时间"}),(0,r.jsxs)("select",{value:W,onChange:e=>J(parseInt(e.target.value,10)),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:1,children:"1秒"}),(0,r.jsx)("option",{value:2,children:"2秒"}),(0,r.jsx)("option",{value:3,children:"3秒"}),(0,r.jsx)("option",{value:5,children:"5秒"})]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 bg-white rounded p-2",children:["\uD83D\uDCA1 ",P?"操作完成后将等待".concat(W,"秒自动继续扫描"):'操作完成后需要手动点击"继续扫描"按钮']})]})]}),I&&!M&&(0,r.jsxs)("div",{className:"bg-white border rounded-xl shadow-lg p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"本场数据"}),U.loading?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"正在加载本场数据..."})]}):(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:U.total}),(0,r.jsx)("div",{className:"text-xs text-blue-600",children:"总报名"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-yellow-900",children:U.registered}),(0,r.jsx)("div",{className:"text-xs text-yellow-600",children:"待入场"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-900",children:U.checkedIn}),(0,r.jsx)("div",{className:"text-xs text-green-600",children:"已入场"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-orange-900",children:U.redeemed}),(0,r.jsx)("div",{className:"text-xs text-orange-600",children:"已核销"})]})]})]}),!e&&!M&&v&&(0,r.jsx)(E,{children:(0,r.jsx)(y,{onScanSuccess:$,isActive:v})}),!e&&!M&&!v&&(0,r.jsx)(c.Zb,{className:"shadow-xl border-0",children:(0,r.jsxs)(c.aY,{className:"text-center py-8",children:[(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"请先选择活动场次"}),(0,r.jsx)(l.z,{onClick:()=>L(!0),children:"选择活动"})]})}),e&&(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)(c.Zb,{className:"shadow-xl border-0 overflow-hidden",children:[(0,r.jsx)(c.Ol,{className:"bg-gradient-to-r from-primary-50 to-indigo-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-primary-600 rounded-xl flex items-center justify-center",children:(0,r.jsx)(b.Z,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.ll,{className:"text-lg",children:e.name}),(0,r.jsx)(c.SZ,{className:"text-base",children:e.phone})]})]}),(0,r.jsx)(o.C,{variant:er(e.status).color,children:er(e.status).text})]})}),(0,r.jsxs)(c.aY,{className:"space-y-6 pt-6",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(()=>{let t=er(e.status);return(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[t.icon&&(0,r.jsx)(t.icon,{className:"w-5 h-5 text-gray-600"}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:t.description})})]})})(),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,r.jsx)("p",{className:"text-blue-600 text-xs mb-1",children:"报名时间"}),(0,r.jsx)("p",{className:"font-medium text-blue-900",children:new Date(e.created_at).toLocaleDateString("zh-CN")})]}),e.check_in_time&&(0,r.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,r.jsx)("p",{className:"text-green-600 text-xs mb-1",children:"入场时间"}),(0,r.jsx)("p",{className:"font-medium text-green-900",children:new Date(e.check_in_time).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})})]})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:["confirmCheckIn"===er(e.status).action&&(0,r.jsxs)(l.z,{onClick:et,disabled:p,className:"w-full h-14 text-base font-medium shadow-lg ".concat(er(e.status).actionColor),children:[(0,r.jsx)(u.Z,{className:"w-5 h-5 mr-2"}),p?"处理中...":"确认入场 (Check In)"]}),"redeem"===er(e.status).action&&(0,r.jsxs)(l.z,{onClick:es,disabled:p,className:"w-full h-14 text-base font-medium shadow-lg ".concat(er(e.status).actionColor),children:[(0,r.jsx)(N.Z,{className:"w-5 h-5 mr-2"}),p?"处理中...":"核销抵用券 (Redeem Voucher)"]}),(0,r.jsx)(l.z,{onClick:ee,variant:"outline",className:"w-full h-12",children:"继续扫描"})]})]})]})}),Z.show&&(0,r.jsx)("div",{className:"global-notification ".concat(Z.type),children:(0,r.jsxs)("div",{className:"global-notification-content",children:[(0,r.jsxs)("div",{className:"text-lg font-medium mb-2",children:["success"===Z.type&&"✅","error"===Z.type&&"❌","warning"===Z.type&&"⚠️"," ","success"===Z.type&&"成功","error"===Z.type&&"错误","warning"===Z.type&&"警告"]}),(0,r.jsx)("div",{className:"text-gray-700",children:Z.message})]})})]})})}},9055:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var r=s(7437);s(2265);var a=s(3027),n=s(231);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",registered:"bg-yellow-100 text-yellow-800 border-yellow-200",checkedIn:"bg-green-100 text-green-800 border-green-200",redeemed:"bg-gray-100 text-gray-800 border-gray-200"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...a})}},9733:function(e,t,s){"use strict";s.d(t,{z:function(){return i}});var r=s(7437),a=s(2265),n=s(231);let i=a.forwardRef((e,t)=>{let{className:s,variant:a="default",size:i="default",...l}=e;return(0,r.jsx)("button",{className:(0,n.cn)("inline-flex items-center justify-center rounded-xl text-sm font-medium transition-all active:scale-95","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",{"bg-primary-600 text-white shadow-lg hover:bg-primary-700 focus-visible:ring-primary-500":"default"===a,"bg-gray-100 text-gray-900 hover:bg-gray-200 focus-visible:ring-gray-500":"secondary"===a,"border border-gray-200 bg-white text-gray-900 hover:bg-gray-50 focus-visible:ring-gray-500":"outline"===a,"text-gray-700 hover:bg-gray-100 focus-visible:ring-gray-500":"ghost"===a,"bg-red-600 text-white shadow-lg hover:bg-red-700 focus-visible:ring-red-500":"destructive"===a},{"h-12 px-6 py-3":"default"===i,"h-10 px-4 py-2":"sm"===i,"h-14 px-8 py-4 text-base":"lg"===i},s),ref:t,...l})});i.displayName="Button"},8185:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var r=s(7437),a=s(2265),n=s(231);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border border-gray-200 bg-white text-gray-950 shadow-sm",s),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",s),...a})});c.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-gray-500",s),...a})});o.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},231:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var r=s(4839),a=s(6164);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}},2686:function(e,t,s){"use strict";s.d(t,{MO:function(){return i},Pd:function(){return a},Pw:function(){return o},Uf:function(){return c},Yr:function(){return r},dn:function(){return n},o3:function(){return l}});let r="00000000-0000-0000-0000-000000000000",a={STAFF_AUTO_CONTINUE_SCAN:"staff_auto_continue_scan",STAFF_WAIT_TIME:"staff_wait_time",STAFF_SELECTED_EVENT_ID:"staff_selected_event_id",STAFF_SELECTED_EVENT_NAME:"staff_selected_event_name"},n={DEFAULT_WAIT_TIME:2,MIN_WAIT_TIME:1,MAX_WAIT_TIME:10,CAMERA_RETRY_DELAY:1e3,SCANNER_RESTART_DELAY:500},i={NOTIFICATION_DURATION:3e3,SCAN_RESULT_DELAY:2e3,ERROR_RETRY_DELAY:5e3,TOAST_AUTO_CLOSE_DELAY:5e3},l={REGISTERED:"registered",CHECKED_IN:"checked_in",REDEEMED:"redeemed"},c={FPS:10,QRBOX_WIDTH:250,QRBOX_HEIGHT:250,CAMERA_LABELS:{BACK:["back","environment","后置"],FRONT:["front","user","前置"]}},o={CHECK_IN_SUCCESS:"已成功入场",REDEEM_SUCCESS:"已完成核销",COPY_SUCCESS:"链接已复制到剪贴板",SAVE_SUCCESS:"保存成功",DELETE_SUCCESS:"删除成功"}},8473:function(e,t,s){"use strict";s.d(t,{k:function(){return a}});class r{formatMessage(e,t,s){let r=new Date().toISOString(),a=this.getEmoji(e);return"".concat(a," [").concat(r,"] ").concat(t)}getEmoji(e){switch(e){case"log":return"\uD83D\uDD0D";case"error":return"❌";case"warn":return"⚠️";case"debug":return"\uD83D\uDC1B";default:return"\uD83D\uDCDD"}}log(e,t){this.isDevelopment&&console.log(this.formatMessage("log",e,t),t||"")}error(e,t){console.error(this.formatMessage("error",e,t),t||"")}warn(e,t){this.isDevelopment&&console.warn(this.formatMessage("warn",e,t),t||"")}debug(e,t){this.isDevelopment&&console.debug(this.formatMessage("debug",e,t),t||"")}group(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isDevelopment&&(t?console.groupCollapsed("\uD83D\uDCC1 ".concat(e)):console.group("\uD83D\uDCC1 ".concat(e)))}groupEnd(){this.isDevelopment&&console.groupEnd()}time(e){this.isDevelopment&&console.time("⏱️ ".concat(e))}timeEnd(e){this.isDevelopment&&console.timeEnd("⏱️ ".concat(e))}table(e,t){this.isDevelopment&&console.table(e,t)}constructor(){this.isDevelopment=!1}}let a=new r},4316:function(e,t,s){"use strict";s.d(t,{O:function(){return i}});var r=s(2562);let a="https://lpbkoksinwcmoniamsvq.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxwYmtva3NpbndjbW9uaWFtc3ZxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2NzAzNjEsImV4cCI6MjA4MDI0NjM2MX0.Be8NAJ8jdZtdl3cTwtsJbjphcePUf7gFHPbxEXjc1_Q";if(!a||!n)throw Error("Supabase URL and Anon Key are required. Please check your environment variables.");let i=(0,r.eI)(a,n)}},function(e){e.O(0,[868,562,494,971,23,744],function(){return e(e.s=9054)}),_N_E=e.O()}]);