(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{109:function(e,t,s){Promise.resolve().then(s.bind(s,758))},758:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return K}});var a=s(7437),r=s(2265),l=s(6463),n=s(9733),i=s(8185),c=s(9055),d=s(231);let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,d.cn)("w-full caption-bottom text-sm",s),...r})})});o.displayName="Table";let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,d.cn)("[&_tr]:border-b",s),...r})});m.displayName="TableHeader";let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,d.cn)("[&_tr:last-child]:border-0",s),...r})});x.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,d.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,d.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});u.displayName="TableRow";let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,d.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});f.displayName="TableHead";let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,d.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});h.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,d.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption";var j=s(9980),p=s(2421),g=s(4392),N=s(2468);let b=j.fC;j.ZA;let y=j.B4,v=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(j.xz,{ref:t,className:(0,d.cn)("flex h-12 w-full items-center justify-between rounded-xl border border-gray-200 bg-white px-4 py-3 text-sm ring-offset-background placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...l,children:[r,(0,a.jsx)(j.JO,{asChild:!0,children:(0,a.jsx)(p.Z,{className:"h-4 w-4 opacity-50"})})]})});v.displayName=j.xz.displayName;let w=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(j.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(g.Z,{className:"h-4 w-4"})})});w.displayName=j.u_.displayName;let _=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(j.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(p.Z,{className:"h-4 w-4"})})});_.displayName=j.$G.displayName;let C=r.forwardRef((e,t)=>{let{className:s,children:r,position:l="popper",...n}=e;return(0,a.jsx)(j.h_,{children:(0,a.jsxs)(j.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-xl border border-gray-200 bg-white text-gray-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...n,children:[(0,a.jsx)(w,{}),(0,a.jsx)(j.l_,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(_,{})]})})});C.displayName=j.VY.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(j.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=j.__.displayName;let E=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(j.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-lg py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(j.wU,{children:(0,a.jsx)(N.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(j.eT,{children:r})]})});E.displayName=j.ck.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(j.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-gray-100",s),...r})}).displayName=j.Z0.displayName;var D=s(2226);let S=D.fC,k=D.xz;D.h_,D.x8;let R=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(D.aV,{ref:t,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:fade-in-0 data-[state=closed]:fade-out-0",s),...r})});R.displayName=D.aV.displayName;let I=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsx)(D.h_,{children:(0,a.jsx)(R,{children:(0,a.jsx)(D.VY,{ref:t,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:fade-in-0 data-[state=closed]:fade-out-0","sm:rounded-lg md:w-full",s),...l,children:r})})})});I.displayName=D.VY.displayName;let T=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})},A=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(D.Dx,{ref:t,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});A.displayName=D.Dx.displayName;let O=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(D.dk,{ref:t,className:(0,d.cn)("text-sm text-muted-foreground",s),...r})});O.displayName=D.dk.displayName;var Z=s(7209),z=s(4316),M=s(8473),Y=s(6763),L=s(3225),F=s(4258),U=s(2513),V=s(4241),P=s(2810),B=s(883),H=s(1240),J=s(8279),W=s(6997),X=s(6884),G=s(656),Q=s(2686);function q(){let e=(0,l.useSearchParams)(),t=(0,l.useRouter)(),{addToast:s}=(0,Y.p)(),[d,j]=(0,r.useState)([]),[p,g]=(0,r.useState)([]),[N,w]=(0,r.useState)(!0),[_,D]=(0,r.useState)(""),[R,q]=(0,r.useState)("all"),[K,$]=(0,r.useState)("all"),[ee,et]=(0,r.useState)([]),[es,ea]=(0,r.useState)(null),[er,el]=(0,r.useState)(!1),[en,ei]=(0,r.useState)(!1),[ec,ed]=(0,r.useState)(null),[eo,em]=(0,r.useState)({name:"",location:"",date:""}),[ex,eu]=(0,r.useState)(!1),[ef,eh]=(0,r.useState)(""),[ej,ep]=(0,r.useState)({total:0,checkedIn:0,redeemed:0,registered:0});(0,r.useEffect)(()=>{let t=e.get("event_id");t&&!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)&&(D("无效的活动ID格式"),M.k.error("Invalid event_id format:",t)),eg(),eN()},[e]),(0,r.useEffect)(()=>{if(ee.length>0){let t=e.get("event_id");if(t){let e=ee.find(e=>e.id===t);if(e){$(t),ea(e);return}D("URL中的活动ID不存在，显示所有活动数据"),M.k.error("Event not found for ID:",t)}"all"===K?ea(ee.length>0?ee[0]:null):"all"!==K&&ea(ee.find(e=>e.id===K)||null)}eb()},[d,R,K,ee,e]);let eg=async()=>{try{let{data:e,error:t}=await z.O.from("events").select("id, name, date, location, created_at").order("created_at",{ascending:!1});if(t)throw t;et(e||[]),e&&e.length>0&&!es&&(ea(e[0]),$(e[0].id))}catch(e){M.k.error("Fetch events error:",e),D("获取活动列表失败，请刷新页面重试")}},eN=async()=>{try{let{data:e,error:t}=await z.O.from("attendees").select("\n          *,\n          event:events (id, name, location, date, created_at)\n        ").order("created_at",{ascending:!1});if(t)throw t;j(e||[])}catch(e){M.k.error("Fetch attendees error:",e),D("获取参与者数据失败，请刷新页面重试")}finally{w(!1)}},eb=()=>{let e=[...d];"all"!==R&&(e=e.filter(e=>e.status===R)),"all"!==K&&(e=e.filter(e=>e.event_id===K)),g(e)};(0,r.useEffect)(()=>{ep(p.reduce((e,t)=>{switch(e.total++,t.status){case"registered":e.registered++;break;case"checked_in":e.checkedIn++;break;case"redeemed":e.redeemed++}return e},{total:0,checkedIn:0,redeemed:0,registered:0}))},[p]);let ey=e=>(0,a.jsx)(c.C,{variant:{registered:"registered",checked_in:"checkedIn",redeemed:"redeemed"}[e],children:{registered:"待入场",checked_in:"已入场",redeemed:"已核销"}[e]}),ev=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}),ew=e=>new Date(e).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),e_=async e=>{if(e.preventDefault(),!eo.name.trim()){s({type:"error",title:"验证失败",message:"请填写活动名称"});return}eu(!0);try{let{data:e,error:t}=await z.O.from("events").insert({name:eo.name.trim(),location:eo.location.trim(),date:eo.date.trim()}).select().single();if(t)throw t;await eg(),em({name:"",location:"",date:""}),ed(e),el(!1),ei(!0)}catch(e){M.k.error("Create event error:",e),s({type:"error",title:"操作失败",message:"创建活动失败，请重试"})}finally{eu(!1)}},eC=async e=>{if(confirm('确认删除活动"'.concat(e.name,'"？\n\n删除活动将同时删除该活动下所有的报名数据，此操作不可恢复！'))){eh(e.id);try{let{error:t}=await z.O.from("attendees").delete().eq("event_id",e.id);if(t)throw t;let{error:a}=await z.O.from("events").delete().eq("id",e.id);if(a)throw a;await eg(),await eN(),s({type:"success",title:"操作成功",message:"活动删除成功"})}catch(e){M.k.error("Delete event error:",e),s({type:"error",title:"操作失败",message:"删除活动失败，请重试"})}finally{eh("")}}},eE=e=>{ed(e),el(!1),ei(!0)},eD=e=>{let t=window.location.origin;return"".concat(t,"/?event_id=").concat(e.id)},eS=e=>{navigator.clipboard.writeText(e).then(()=>{s({type:"success",title:"复制成功",message:Q.Pw.COPY_SUCCESS})}).catch(()=>{s({type:"error",title:"复制失败",message:"请手动复制链接"})})};return N?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"加载数据中..."})]})}):!_||d.length||ee.length?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto space-y-8",children:[_&&(d.length>0||ee.length>0)&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mt-0.5 text-yellow-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-yellow-700",children:_}),(0,a.jsx)("p",{className:"text-xs text-yellow-600 mt-1",children:"页面功能正常，但某些数据可能无法显示"})]})]})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-primary-500 to-primary-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:(0,a.jsx)(L.Z,{className:"w-10 h-10 text-white"})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"数据看板"}),(0,a.jsx)("p",{className:"text-gray-600",children:"活动签到与核销数据统计"})]}),(0,a.jsx)(i.Zb,{className:"shadow-xl border-0",children:(0,a.jsx)(i.Ol,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(i.ll,{className:"text-lg",children:"活动筛选"}),(0,a.jsx)(i.SZ,{children:"all"===K?"显示所有活动的数据":es?"当前显示：".concat(es.name," (").concat(es.location,")"):"选择一个活动查看数据"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)(b,{value:K,onValueChange:$,children:[(0,a.jsx)(v,{className:"w-48 min-w-0",children:(0,a.jsx)(y,{placeholder:"选择活动"})}),(0,a.jsxs)(C,{className:"w-48 max-w-48 overflow-hidden",children:[(0,a.jsx)(E,{value:"all",children:"全部活动"}),ee.map(e=>(0,a.jsxs)(E,{value:e.id,className:"truncate",children:[e.name," - ",e.location]},e.id))]})]}),(0,a.jsxs)(S,{open:er,onOpenChange:el,children:[(0,a.jsx)(k,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"outline",size:"sm",children:[(0,a.jsx)(F.Z,{className:"w-4 h-4 mr-2"}),"活动管理"]})}),(0,a.jsxs)(I,{className:"sm:max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)(T,{children:[(0,a.jsx)(A,{className:"text-center",children:"活动管理"}),(0,a.jsx)(O,{className:"text-center",children:"创建新活动或管理现有活动"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,a.jsx)(U.Z,{className:"w-5 h-5 mr-2"}),"创建新活动"]}),(0,a.jsxs)("form",{onSubmit:e_,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["活动名称 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(Z.I,{value:eo.name,onChange:e=>em({...eo,name:e.target.value}),placeholder:"请输入活动名称",disabled:ex})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"活动地点"}),(0,a.jsx)(Z.I,{value:eo.location,onChange:e=>em({...eo,location:e.target.value}),placeholder:"请输入活动地点",disabled:ex})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"活动日期"}),(0,a.jsx)(Z.I,{type:"date",value:eo.date,onChange:e=>em({...eo,date:e.target.value}),disabled:ex})]}),(0,a.jsx)(n.z,{type:"submit",className:"w-full",disabled:ex,children:ex?"创建中...":"创建活动"})]})]}),(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,a.jsx)(V.Z,{className:"w-5 h-5 mr-2"}),"现有活动"]}),0===ee.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"暂无活动"}):(0,a.jsx)("div",{className:"space-y-3",children:ee.map(e=>(0,a.jsx)("div",{className:"border rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[e.location&&(0,a.jsxs)("span",{children:["\uD83D\uDCCD ",e.location]}),e.date&&(0,a.jsxs)("span",{className:"ml-2",children:["\uD83D\uDCC5 ",e.date]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>eE(e),children:[(0,a.jsx)(P.Z,{className:"w-4 h-4 mr-1"}),"链接"]}),(0,a.jsxs)(n.z,{variant:"destructive",size:"sm",onClick:()=>eC(e),disabled:ef===e.id,children:[(0,a.jsx)(B.Z,{className:"w-4 h-4"}),ef===e.id?"删除中...":"删除"]})]})]})},e.id))})]})]})]})]})]})]})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)(i.Zb,{className:"shadow-xl border-0",children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"总报名数"}),(0,a.jsx)(H.Z,{className:"h-4 w-4 text-blue-600"})]}),(0,a.jsxs)(i.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:ej.total}),(0,a.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"活动总报名人数"})]})]}),(0,a.jsxs)(i.Zb,{className:"shadow-xl border-0",children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"待入场"}),(0,a.jsx)(V.Z,{className:"h-4 w-4 text-yellow-600"})]}),(0,a.jsxs)(i.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-900",children:ej.registered}),(0,a.jsx)("p",{className:"text-xs text-yellow-600 mt-1",children:"已报名待入场"})]})]}),(0,a.jsxs)(i.Zb,{className:"shadow-xl border-0",children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"已入场"}),(0,a.jsx)(J.Z,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsxs)(i.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-900",children:ej.checkedIn}),(0,a.jsx)("p",{className:"text-xs text-green-600 mt-1",children:"已完成签到入场"})]})]}),(0,a.jsxs)(i.Zb,{className:"shadow-xl border-0",children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"已核销"}),(0,a.jsx)(W.Z,{className:"h-4 w-4 text-orange-600"})]}),(0,a.jsxs)(i.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-900",children:ej.redeemed}),(0,a.jsx)("p",{className:"text-xs text-orange-600 mt-1",children:"已核销抵用券"})]})]})]}),(0,a.jsxs)(i.Zb,{className:"shadow-xl border-0",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(i.ll,{className:"text-lg",children:"参会人员列表"}),(0,a.jsxs)(i.SZ,{children:["共 ",p.length," 条记录","all"!==K&&es&&(0,a.jsxs)("span",{className:"ml-2 text-blue-600",children:["(活动：",es.name,")"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"筛选状态："}),(0,a.jsxs)(b,{value:R,onValueChange:q,children:[(0,a.jsx)(v,{className:"w-32",children:(0,a.jsx)(y,{placeholder:"选择状态"})}),(0,a.jsxs)(C,{children:[(0,a.jsx)(E,{value:"all",children:"全部"}),(0,a.jsx)(E,{value:"registered",children:"待入场"}),(0,a.jsx)(E,{value:"checked_in",children:"已入场"}),(0,a.jsx)(E,{value:"redeemed",children:"已核销"})]})]})]})]})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(o,{children:[(0,a.jsx)(m,{children:(0,a.jsxs)(u,{children:[(0,a.jsx)(f,{children:"姓名"}),(0,a.jsx)(f,{children:"手机号"}),(0,a.jsx)(f,{children:"状态"}),(0,a.jsx)(f,{children:"活动"}),(0,a.jsx)(f,{children:"报名时间"}),(0,a.jsx)(f,{children:"入场时间"})]})}),(0,a.jsx)(x,{children:0===p.length?(0,a.jsx)(u,{children:(0,a.jsx)(h,{colSpan:6,className:"text-center py-8 text-gray-500",children:"all"===R&&"all"===K?"暂无数据":"该筛选条件下暂无数据"})}):p.map(e=>{var t,s;return(0,a.jsxs)(u,{className:"hover:bg-gray-50",children:[(0,a.jsx)(h,{className:"font-medium",children:e.name}),(0,a.jsx)(h,{children:e.phone}),(0,a.jsx)(h,{children:ey(e.status)}),(0,a.jsxs)(h,{children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:(null===(t=e.event)||void 0===t?void 0:t.name)||"未知活动"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:(null===(s=e.event)||void 0===s?void 0:s.location)||""})]}),(0,a.jsx)(h,{children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-sm",children:ev(e.created_at)}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:ew(e.created_at)})]})}),(0,a.jsx)(h,{children:e.check_in_time?(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-sm",children:ev(e.check_in_time)}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:ew(e.check_in_time)})]}):(0,a.jsx)("span",{className:"text-gray-400",children:"-"})})]},e.id)})})]})})})]}),ec&&(0,a.jsx)(S,{open:en,onOpenChange:ei,children:(0,a.jsxs)(I,{className:"sm:max-w-md",children:[(0,a.jsxs)(T,{children:[(0,a.jsx)(A,{className:"text-center",children:"活动报名二维码"}),(0,a.jsx)(O,{className:"text-center",children:"用户扫描此二维码可直接进入活动报名页面"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-4",children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:ec.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 flex items-center justify-center",children:[(0,a.jsx)(V.Z,{className:"w-4 h-4 mr-1"}),ec.location||"未指定地点"]})]}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-inner",children:(0,a.jsx)(G.ZP,{value:eD(ec),size:200})}),(0,a.jsxs)("div",{className:"space-y-2 w-full",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"报名链接："}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",readOnly:!0,value:eD(ec),className:"flex-1 text-xs p-2 border rounded bg-gray-50",onClick:e=>e.target.select()}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>eS(eD(ec)),children:(0,a.jsx)(X.Z,{className:"w-4 h-4"})})]})]})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3",children:[(0,a.jsx)(n.z,{onClick:()=>{es&&es.id&&es.id!==Q.Yr?t.push("/?event_id=".concat(es.id)):t.push("/")},variant:"outline",className:"flex-1",children:"返回首页"}),(0,a.jsx)(n.z,{onClick:()=>t.push("/staff/scan"),className:"flex-1",children:"开始扫码"})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:(0,a.jsx)(i.Zb,{className:"w-full max-w-md shadow-xl border-0",children:(0,a.jsx)(i.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"加载失败"}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:_}),(0,a.jsx)(n.z,{onClick:()=>window.location.reload(),className:"w-full",children:"刷新页面"})]})]})})})})}function K(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"加载中..."})]})}),children:(0,a.jsx)(q,{})})}},9055:function(e,t,s){"use strict";s.d(t,{C:function(){return i}});var a=s(7437);s(2265);var r=s(3027),l=s(231);let n=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",registered:"bg-yellow-100 text-yellow-800 border-yellow-200",checkedIn:"bg-green-100 text-green-800 border-green-200",redeemed:"bg-gray-100 text-gray-800 border-gray-200"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)(n({variant:s}),t),...r})}},9733:function(e,t,s){"use strict";s.d(t,{z:function(){return n}});var a=s(7437),r=s(2265),l=s(231);let n=r.forwardRef((e,t)=>{let{className:s,variant:r="default",size:n="default",...i}=e;return(0,a.jsx)("button",{className:(0,l.cn)("inline-flex items-center justify-center rounded-xl text-sm font-medium transition-all active:scale-95","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",{"bg-primary-600 text-white shadow-lg hover:bg-primary-700 focus-visible:ring-primary-500":"default"===r,"bg-gray-100 text-gray-900 hover:bg-gray-200 focus-visible:ring-gray-500":"secondary"===r,"border border-gray-200 bg-white text-gray-900 hover:bg-gray-50 focus-visible:ring-gray-500":"outline"===r,"text-gray-700 hover:bg-gray-100 focus-visible:ring-gray-500":"ghost"===r,"bg-red-600 text-white shadow-lg hover:bg-red-700 focus-visible:ring-red-500":"destructive"===r},{"h-12 px-6 py-3":"default"===n,"h-10 px-4 py-2":"sm"===n,"h-14 px-8 py-4 text-base":"lg"===n},s),ref:t,...i})});n.displayName="Button"},8185:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return n},aY:function(){return o},ll:function(){return c}});var a=s(7437),r=s(2265),l=s(231);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border border-gray-200 bg-white text-gray-950 shadow-sm",s),...r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-gray-500",s),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},7209:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var a=s(7437),r=s(2265),l=s(231);let n=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-12 w-full rounded-xl border border-gray-200 bg-white px-4 py-3 text-sm","placeholder:text-gray-400","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...n})});n.displayName="Input"},6763:function(e,t,s){"use strict";s.d(t,{p:function(){return l},u:function(){return r}});var a=s(2265);let r=(0,a.createContext)(void 0),l=()=>{let e=(0,a.useContext)(r);if(!e)throw Error("useToast must be used within a ToastProvider");return e}},231:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var a=s(4839),r=s(6164);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},2686:function(e,t,s){"use strict";s.d(t,{MO:function(){return n},Pd:function(){return r},Pw:function(){return d},Uf:function(){return c},Yr:function(){return a},dn:function(){return l},o3:function(){return i}});let a="00000000-0000-0000-0000-000000000000",r={STAFF_AUTO_CONTINUE_SCAN:"staff_auto_continue_scan",STAFF_WAIT_TIME:"staff_wait_time",STAFF_SELECTED_EVENT_ID:"staff_selected_event_id",STAFF_SELECTED_EVENT_NAME:"staff_selected_event_name"},l={DEFAULT_WAIT_TIME:2,MIN_WAIT_TIME:1,MAX_WAIT_TIME:10,CAMERA_RETRY_DELAY:1e3,SCANNER_RESTART_DELAY:500},n={NOTIFICATION_DURATION:3e3,SCAN_RESULT_DELAY:2e3,ERROR_RETRY_DELAY:5e3,TOAST_AUTO_CLOSE_DELAY:5e3},i={REGISTERED:"registered",CHECKED_IN:"checked_in",REDEEMED:"redeemed"},c={FPS:10,QRBOX_WIDTH:250,QRBOX_HEIGHT:250,CAMERA_LABELS:{BACK:["back","environment","后置"],FRONT:["front","user","前置"]}},d={CHECK_IN_SUCCESS:"已成功入场",REDEEM_SUCCESS:"已完成核销",COPY_SUCCESS:"链接已复制到剪贴板",SAVE_SUCCESS:"保存成功",DELETE_SUCCESS:"删除成功"}},8473:function(e,t,s){"use strict";s.d(t,{k:function(){return r}});class a{formatMessage(e,t,s){let a=new Date().toISOString(),r=this.getEmoji(e);return"".concat(r," [").concat(a,"] ").concat(t)}getEmoji(e){switch(e){case"log":return"\uD83D\uDD0D";case"error":return"❌";case"warn":return"⚠️";case"debug":return"\uD83D\uDC1B";default:return"\uD83D\uDCDD"}}log(e,t){this.isDevelopment&&console.log(this.formatMessage("log",e,t),t||"")}error(e,t){console.error(this.formatMessage("error",e,t),t||"")}warn(e,t){this.isDevelopment&&console.warn(this.formatMessage("warn",e,t),t||"")}debug(e,t){this.isDevelopment&&console.debug(this.formatMessage("debug",e,t),t||"")}group(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isDevelopment&&(t?console.groupCollapsed("\uD83D\uDCC1 ".concat(e)):console.group("\uD83D\uDCC1 ".concat(e)))}groupEnd(){this.isDevelopment&&console.groupEnd()}time(e){this.isDevelopment&&console.time("⏱️ ".concat(e))}timeEnd(e){this.isDevelopment&&console.timeEnd("⏱️ ".concat(e))}table(e,t){this.isDevelopment&&console.table(e,t)}constructor(){this.isDevelopment=!1}}let r=new a},4316:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});var a=s(2562);let r="https://lpbkoksinwcmoniamsvq.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxwYmtva3NpbndjbW9uaWFtc3ZxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2NzAzNjEsImV4cCI6MjA4MDI0NjM2MX0.Be8NAJ8jdZtdl3cTwtsJbjphcePUf7gFHPbxEXjc1_Q";if(!r||!l)throw Error("Supabase URL and Anon Key are required. Please check your environment variables.");let n=(0,a.eI)(r,l)}},function(e){e.O(0,[868,562,603,88,971,23,744],function(){return e(e.s=109)}),_N_E=e.O()}]);